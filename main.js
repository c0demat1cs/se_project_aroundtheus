!function(){"use strict";class e{constructor(e,t,s,i,r,n){let{name:o,link:l,_id:a,isLiked:d}=e;this._name=o,this._link=l,this._id=a,this.isLiked=d,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteCard=i,this._handleLikeClick=r,this._handleUnlikeClick=n}getId(){return this._id}getIsLiked(){return this._isLiked}_getElement(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getView(){return this._cardElement=this._getElement(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImageEl=this._cardElement.querySelector(".card__image"),this._cardTitleEl=this._cardElement.querySelector(".card__title"),this._cardImageEl.src=this._link,this._cardImageEl.alt=this._name,this._cardTitleEl.textContent=this._name,this._setEventListeners(),this._setLikeState(),this._cardElement}_setLikeState(){!0===this.isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}handleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button_active")};_setEventListeners(){this._likeButton.addEventListener("click",(()=>{!0===this.isLiked?this._handleUnlikeClick(this):this._handleLikeClick(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this)})),this._cardImageEl.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}deleteCard=()=>{this._cardElement.remove(),this._cardElement=null}}class t{constructor(e,t){this._formElement=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._inputElements=this._formElement.querySelectorAll(this._inputSelector),this._submitButton=this._formElement.querySelector(this._submitButtonSelector)}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){if(!e.validity.valid)return this._showInputError(e);this._hideInputError(e)}_hasInvalidInput(){return Array.from(this._inputElements).some((e=>!e.validity.valid))}_disableButton(){this._submitButton&&(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}_enableButton(){this._submitButton&&(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():this._enableButton()}_setEventListeners(){this._inputElements.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._inputElements.forEach((e=>{this._checkInputValidity(e)})),this._toggleButtonState()}disableSubmitButton(){this._disableButton()}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class s{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._handleKeyDown=this._handleKeyDown.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleKeyDown)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleKeyDown)}_handleKeyDown(e){"Escape"===e.key&&this.close()}setEventListeners(){const e=this._popupElement.querySelector(".modal__close");e&&e.addEventListener("click",(()=>this.close())),this._popupElement.addEventListener("mousedown",(e=>{e.target.classList.contains("modal_opened")&&this.close()}))}}var i=class extends s{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputFields=this._popupForm.querySelectorAll(".modal__input"),this._formSubmitHandler=this._formSubmitHandler.bind(this),this._submitBtn=this._popupForm.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}_getInputValues(){const e={};return this._inputFields.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._formSubmitHandler)}_formSubmitHandler(e){e.preventDefault(),this._handleFormSubmit(this._getInputValues())}close(){this._popupForm.reset(),super.close()}};const r={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},n=(document.querySelector(".cards__list"),document.querySelector("#profile-edit-modal"),document.querySelector("#add-card-modal"),document.querySelector(".modal__image"),document.querySelector(".modal__popup-caption"),document.querySelector("#profile-add-button")),o=document.querySelector("#profile-edit-button"),l=document.querySelector(".profile__edit-icon"),a=(document.querySelector("#card-title-input"),document.querySelector("#card-link-input"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),d=document.querySelector("#profile-description-input");document.forms["profile-form"],document.forms["card-form"];const c=new t(r,document.querySelector("#profile-form"));c.enableValidation();const u=new t(r,document.querySelector("#add-card-form"));u.enableValidation();const h=new t(r,document.querySelector("#avatar-form"));h.enableValidation();const _=new i("#add-card-modal",(e=>{var t,s;t=e.title,s=e.link,_.renderLoading(!0),v.addNewCard({name:t,link:s}).then((e=>{!function(e){const t=k(e);S.addItem(t)}(e),u.disableSubmitButton(),_.close()})).catch((e=>{console.error(e)})).finally((()=>{_.renderLoading(!1)}))}));_.setEventListeners();const m=new i("#profile-edit-modal",(function(e){let{title:t,description:s}=e;m.renderLoading(!0),v.editProfileInfo({name:t,about:s}).then((e=>{f.setUserInfo(e.name,e.about),c.disableSubmitButton(),m.close()})).catch((e=>{console.error(e)})).finally((()=>{m.renderLoading(!1)}))}));m.setEventListeners();const p=new class extends s{constructor(e){super({popupSelector:e}),this._popupCaption=this._popupElement.querySelector(".modal__popup-caption"),this._imageElement=this._popupElement.querySelector(".modal__image")}open(e){let{link:t,name:s}=e;this._popupCaption.textContent=s,this._imageElement.src=t,this._imageElement.alt=`Image of ${s}`,super.open()}}("#image-modal");p.setEventListeners();const E=new class extends s{constructor(e){super({popupSelector:e})}setEventListeners(){super.setEventListeners(),this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleSubmit()}))}setSubmitCallback(e){this._handleSubmit=e}}("#delete-card-modal",y);E.setEventListeners();const b=new i("#avatar-modal",(function(e){b.renderLoading(!0);const t=e.link;v.updateAvatar({avatar:t}).then((e=>{b.close(),f.setAvatar(e.avatar),h.disableSubmitButton()})).catch((e=>{console.error(e)})).finally((()=>{b.renderLoading(!1)}))}));b.setEventListeners();const f=new class{constructor(e,t,s){this._profileTitleElement=document.querySelector(e),this._profileDescriptionElement=document.querySelector(t),this._profileAvatarElement=document.querySelector(s)}getUserInfo(){return{title:this._profileTitleElement.textContent,description:this._profileDescriptionElement.textContent}}setUserInfo(e,t){this._profileTitleElement.textContent=e,this._profileDescriptionElement.textContent=t}setAvatar(e){this._profileAvatarElement.src=e}}(".profile__title",".profile__description",".profile__image"),v=new class{constructor(e){this.baseUrl=e.baseUrl,this.headers=e.headers,this._checkResponse=this._checkResponse.bind(this)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}getUserInfo(){return this._request(`${this.baseUrl}/users/me`,{headers:this.headers})}getInitialCards(){return this._request(`${this.baseUrl}/cards`,{headers:this.headers})}editProfileInfo(e){let{name:t,about:s}=e;return this._request(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:s})})}addNewCard(e){let{name:t,link:s}=e;return this._request(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:s})})}deleteCard(e){return this._request(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers})}likeCard(e){return this._request(`${this.baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this.headers})}removeLike(e){return this._request(`${this.baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this.headers})}updateAvatar(e){let{avatar:t}=e;return this._request(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"d918969b-47fa-4f72-8138-61be6ab55840","Content-Type":"application/json"}}),S=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({renderer:e=>{S.addItem(k(e))}},".cards__list");function k(t){return new e(t,"#card-template",L,y,g,C).getView()}function L(e){let{name:t,link:s}=e;p.open({link:s,name:t})}function y(e){E.open(),E.setSubmitCallback((()=>{v.deleteCard(e.getId()).then((()=>{e.deleteCard(),E.close()})).catch((e=>{console.error(e)}))}))}function g(e){v.likeCard(e._id).then((t=>{e.handleLikeIcon(),e.isLiked=!0,console.log("Card liked:",t)})).catch((e=>{console.error(e)}))}function C(e){v.removeLike(e._id).then((t=>{e.handleLikeIcon(),e.isLiked=!1,console.log("Card disliked:",t)})).catch((e=>{console.log(e)}))}v.getInitialCards().then((e=>{S.renderItems(e.reverse())})).catch((e=>{console.error(e)})),v.getUserInfo().then((e=>{f.setUserInfo(e.name,e.about),f.setAvatar(e.avatar)})).catch((e=>{console.error(e)})),o.addEventListener("click",(()=>{const e=f.getUserInfo();a.value=e.title,d.value=e.description,c.resetValidation(),m.open()})),n.addEventListener("click",(()=>{_.open()})),l.addEventListener("click",(()=>{b.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWtCcU0sR0FDekJ6RSxFQUNHNkQsV0FBV1ksRUFBS2xNLEtBQ2hCMkgsTUFBTUMsSUFDTHNFLEVBQUtuSyxpQkFDTG1LLEVBQUtqTSxTQUFVLEVBQ2ZvSSxRQUFROEQsSUFBSSxpQkFBa0J2RSxFQUFLLElBRXBDTyxPQUFPQyxJQUNOQyxRQUFROEQsSUFBSS9ELEVBQUksR0FFdEIsQ0E5SUFYLEVBQ0dzRCxrQkFDQXBELE1BQU15RSxJQVNMcEUsRUFBUTZELFlBQVlPLEVBQU9DLFVBQVUsSUFFdENsRSxPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLElBSXRCWCxFQUNHd0MsY0FDQXRDLE1BQU15RSxJQUVMdkQsRUFBU0MsWUFBWXNELEVBQU90TSxLQUFNc00sRUFBT3hELE9BQ3pDQyxFQUFTYSxVQUFVMEMsRUFBTzVDLE9BQU8sSUFFbENyQixPQUFPQyxJQUNOQyxRQUFRQyxNQUFNRixFQUFJLElBNkl0QnZCLEVBQWtCNUUsaUJBQWlCLFNBQVMsS0FDMUMsTUFBTXFLLEVBQVd6RCxFQUFTb0IsY0FDMUJsRCxFQUFrQk4sTUFBUTZGLEVBQVM5RSxNQUNuQ1IsRUFBd0JQLE1BQVE2RixFQUFTNUQsWUFDekN4QixFQUFrQjVDLGtCQUNsQmtFLEVBQWlCeEQsTUFBTSxJQUl6QjRCLEVBQWlCM0UsaUJBQWlCLFNBQVMsS0FDekNvRixFQUFhckMsTUFBTSxJQUlyQjhCLEVBQW9CN0UsaUJBQWlCLFNBQVMsS0FDNUNzSCxFQUFrQnZFLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgeyBuYW1lLCBsaW5rLCBfaWQsIGlzTGlrZWQgfSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBfaGFuZGxlRGVsZXRlQ2FyZCxcbiAgICBoYW5kbGVMaWtlQ2xpY2ssXG4gICAgaGFuZGxlVW5saWtlQ2xpY2tcbiAgKSB7XG4gICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgdGhpcy5faWQgPSBfaWQ7XG4gICAgdGhpcy5pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCA9IF9oYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVVbmxpa2VDbGljayA9IGhhbmRsZVVubGlrZUNsaWNrO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2lkO1xuICB9XG5cbiAgLy8gZ2V0IHRoZSBsaWtlIHN0YXR1c1xuICBnZXRJc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xuICB9XG5cbiAgLy8gIE1FVEhPRFNcbiAgLy9hYnN0cmFjdGlvbiB0byBnZXQgdGhlIGNhcmQgZWxlbWVudFxuICBfZ2V0RWxlbWVudCgpIHtcbiAgICByZXR1cm4gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcbiAgfVxuXG4gIC8vIGdldFZpZXcgZGVmaW5lcyB0aGUgY2FyZCBlbGVtZW50XG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRFbGVtZW50KCk7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgdGhpcy5fY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2VFbC5zcmMgPSB0aGlzLl9saW5rO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgdGhpcy5fY2FyZFRpdGxlRWwudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9zZXRMaWtlU3RhdGUoKTtcbiAgICAvLyByZXR1cm4gdGhlIGNhcmRcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cblxuICBfc2V0TGlrZVN0YXRlKCkge1xuICAgIC8vIGlmIHRoZSBidXR0b24gaXMgbGlrZWRcbiAgICAvLyBzaG93IHRoZSBzdGF0ZSBvZiB0aGUgYnV0dG9uXG4gICAgaWYgKHRoaXMuaXNMaWtlZCA9PT0gdHJ1ZSkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlTGlrZUljb24gPSAoKSA9PiB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9O1xuXG4gIC8vIExJU1RFTkVSU1xuICAvLyBmZXRjaCBlYWNoIGVsZW1lbnQgLCBhZGQgbGlzdGVuZXJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIGlmICh0aGlzLmlzTGlrZWQgPT09IHRydWUpIHtcbiAgICAgICAgdGhpcy5faGFuZGxlVW5saWtlQ2xpY2sodGhpcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XG4gICAgICB9XG4gICAgICAvL3RoaXMuX2hhbmRsZUxpa2VJY29uKCk7XG4gICAgfSk7XG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgLy8gSGFuZGxlIGltYWdlIGNsaWNrXG4gICAgdGhpcy5fY2FyZEltYWdlRWwuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gSEFORExFUlM7XG5cbiAgZGVsZXRlQ2FyZCA9ICgpID0+IHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH07XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBzZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gc2V0dGluZ3MuZXJyb3JDbGFzcztcblxuICAgIC8vIFNhdmUgZWxlbWVudHMgaW4gdGhlIGNsYXNzIGluc3RhbmNlXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXG4gICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yXG4gICAgKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcbiAgICApO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXG4gICAgKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xuICAgIGVycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICByZXR1cm4gdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgfVxuXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5faW5wdXRFbGVtZW50cykuc29tZShcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWRcbiAgICApO1xuICB9XG5cbiAgX2Rpc2FibGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX3N1Ym1pdEJ1dHRvbikge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIF9lbmFibGVCdXR0b24oKSB7XG4gICAgaWYgKHRoaXMuX3N1Ym1pdEJ1dHRvbikge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XG4gICAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xuICAgIH1cbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICByZXNldFZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgIH0pO1xuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gIH1cblxuICBkaXNhYmxlU3VibWl0QnV0dG9uKCkge1xuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVLZXlEb3duID0gdGhpcy5faGFuZGxlS2V5RG93bi5iaW5kKHRoaXMpO1xuICB9XG5cbiAgLy8gb3BlbnMgcG9wdXBcbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVLZXlEb3duKTtcbiAgfVxuXG4gIC8vIGNsb3NlcyBwb3B1cFxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVLZXlEb3duKTtcbiAgfVxuXG4gIC8vIGxpc3RlbnMgZm9yIGVzYyBidXR0b25cbiAgX2hhbmRsZUtleURvd24oZXZ0KSB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH1cblxuICAvLyBzZXRzIGV2ZW50IGxpc3RlbmVyc1xuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBjb25zdCBjbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgICBpZiAoY2xvc2VCdXR0b24pIHtcbiAgICAgIGNsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICAgIH1cbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9vcGVuZWRcIikpIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iLCIvLyB0aGlzIGNsYXNzIGlzIGEgY2hpbGQgY2xhc3Mgb2YgdGhlIFBvcHVwIGNsYXNzXG4vLyBpdCBkZWFscyBleGNsdXNpdmVseSB3aXRoIGZvcm1zXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTsgLy8gY2FsbCB0aGUgY29uc3RydWN0b3Igb2YgdGhlIHBhcmVudCBjbGFzcyBQb3B1cFxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpOyAvLyBhY2Nlc3MgdGhlIGZvcm0gZWxlbWVudCBpbnNpZGUgdGhlIHBvcHVwXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7IC8vIHNhdmUgdGhlIGhhbmRsZUZvcm1TdWJtaXQgZnVuY3Rpb24gZm9yIGxhdGVyIHVzZVxuICAgIHRoaXMuX2lucHV0RmllbGRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX2Zvcm1TdWJtaXRIYW5kbGVyID0gdGhpcy5fZm9ybVN1Ym1pdEhhbmRsZXIuYmluZCh0aGlzKTsgLy8gYmluZHMgZXZ0IGxzdG5yIHRvIHRoaXNcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpOyAvLyBhY2Nlc3MgdGhlIHN1Ym1pdCBidXR0b25cbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyByZXR1cm4gYmFjayB0aGUgaW5pdGlhbCB0ZXh0IG9mIHRoZSBidXR0b25cbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XG4gICAgfVxuICB9XG5cbiAgLy8gY29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIGl0IGFzIGFuIG9iamVjdFxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9pbnB1dEZpZWxkcy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICAvLyBvdmVycmlkZSB0aGUgcGFyZW50IG1ldGhvZFxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIC8vIGxpc3RlbnMgZm9yIGZvcm0gc3VibWlzc2lvblxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2Zvcm1TdWJtaXRIYW5kbGVyKTtcbiAgfVxuICAvLyBoYW5kbGUgZm9ybSBzdWJtaXRcbiAgX2Zvcm1TdWJtaXRIYW5kbGVyKGV2dCkge1xuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gIH1cblxuICAvLyBjbG9zZXMgYW5kIHJlc2V0cyB0aGUgZm9ybVxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcbiAgICBzdXBlci5jbG9zZSgpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aEZvcm07XG4iLCJleHBvcnQgY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuLy8gV1JBUFBFUlNcbmV4cG9ydCBjb25zdCBwbGFjZXNXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5leHBvcnQgY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmV4cG9ydCBjb25zdCBtb2RhbEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XG5leHBvcnQgY29uc3QgaW1hZ2VDYXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcG9wdXAtY2FwdGlvblwiKTtcblxuLy8gQlVUVE9OUyBBTkQgT1RIRVIgRE9NIEVMRU1FTlRTXG5leHBvcnQgY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVBdmF0YXJCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIi5wcm9maWxlX19lZGl0LWljb25cIlxuKTtcblxuLy8gRk9STSBEQVRBXG5leHBvcnQgY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGl0bGUtaW5wdXRcIik7XG5leHBvcnQgY29uc3QgY2FyZExpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1saW5rLWlucHV0XCIpO1xuZXhwb3J0IGNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5leHBvcnQgY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmV4cG9ydCBjb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1mb3JtXCJdO1xuZXhwb3J0IGNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJjYXJkLWZvcm1cIl07XG4iLCJpbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuaW1wb3J0IHtcbiAgc2V0dGluZ3MsXG4gIHByb2ZpbGVBZGRCdXR0b24sXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBwcm9maWxlQXZhdGFyQnV0dG9uLFxuICBwcm9maWxlVGl0bGVJbnB1dCxcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cXFxuXG4vLyA9PT09PT09PT0gIEZPUk0gVkFMSURBVE9SUyAgPT09PT09PT09IC8vXG5cbi8vIE5ldyBFZGl0IEZvcm0gVmFsaWRhdG9yIGluc3RhbmNlXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBzZXR0aW5ncyxcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWZvcm1cIilcbik7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7IC8vIGNhbGwgZW5hYmxlIHZhbGlkYXRpb25cblxuLy8gTmV3IENhcmQgZm9ybSB2YWxpZGF0b3IgaW5zdGFuY2VcbmNvbnN0IGNhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHNldHRpbmdzLFxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIilcbik7XG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7IC8vIGNhbGwgZW5hYmxlIHZhbGlkYXRpb25cblxuLy8gbmV3IGF2YXRhciBmb3JtIHZhbGlkYXRvciBpbnN0YW5jZVxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICBzZXR0aW5ncyxcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItZm9ybVwiKVxuKTtcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpOyAvLyBjYWxsIGVuYWJsZSB2YWxpZGF0aW9uXG5cbi8vID09PT09PT09PSAgUE9QVVAgQ0xBU1MgSU5TVEFOQ0VTID09PT09PT09PSAvL1xuXG4vLyBOZXcgUG9wdXAgRm9ybSBmb3IgYWRkaW5nIGEgY2FyZFxuY29uc3QgbmV3Q2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwgKGZvcm1EYXRhKSA9PiB7XG4gIGNvbnN0IG5hbWUgPSBmb3JtRGF0YS50aXRsZTtcbiAgY29uc3QgbGluayA9IGZvcm1EYXRhLmxpbms7XG4gIGhhbmRsZU5ld0NhcmRTdWJtaXQobmFtZSwgbGluayk7XG59KTtcbm5ld0NhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBOZXcgUG9wdXAgRm9ybSB0byBlZGl0IHByb2ZpbGVcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XG4pO1xuZWRpdFByb2ZpbGVQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBOZXcgUG9wdXAgd2l0aCBJbWFnZVxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtbW9kYWxcIik7XG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyBuZXcgcG9wdXAgZm9yIGRlbGV0aW5nIGEgY2FyZFxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcbiAgXCIjZGVsZXRlLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlRGVsZXRlQ2FyZFxuKTtcbi8vIHNldCBldmVudCBsaXN0ZW5lcnMgZm9yIGRlbGV0ZSBjYXJkIHBvcHVwXG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gbmV3IHBvcHVwIGZvciBjaGFuZ2luZyBhdmF0YXJcbmNvbnN0IGNoYW5nZUF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2F2YXRhci1tb2RhbFwiLFxuICBoYW5kbGVBdmF0YXJTdWJtaXRcbik7XG5jaGFuZ2VBdmF0YXJQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vLyA9PT09PT09PT0gIFVTRVIgSU5GTyAgPT09PT09PT09IC8vXG5cbi8vIEluc3RhbmNlIG9mIFVzZXIgSW5mb1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oXG4gIFwiLnByb2ZpbGVfX3RpdGxlXCIsXG4gIFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIFwiLnByb2ZpbGVfX2ltYWdlXCJcbik7XG5cbi8vID09PT09PT09PSAgU0VDVElPTiAgPT09PT09PT09IC8vXG5cbi8vID09PT09PT09PSAgQVBJcyAgPT09PT09PT09IC8vXG5cbi8vIEluc3RhbmNlIG9mIEFwaVxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiZDkxODk2OWItNDdmYS00ZjcyLTgxMzgtNjFiZTZhYjU1ODQwXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICB7XG4gICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XG4gICAgICBzZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChkYXRhKSk7XG4gICAgfSxcbiAgfSxcbiAgXCIuY2FyZHNfX2xpc3RcIlxuKTtcblxuLy8gZmV0Y2ggYW5kIHJlbmRlciBpbml0aWFsIGNhcmRzXG5hcGlcbiAgLmdldEluaXRpYWxDYXJkcygpXG4gIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAvLyAvLyBJbnN0YW5jZSBvZiBTZWN0aW9uXG4gICAgLy8gbGV0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAvLyAgIHtcbiAgICAvLyAgICAgaXRlbXM6IHJlc3VsdC5yZXZlcnNlKCksXG4gICAgLy8gICAgIHJlbmRlcmVyOiBjcmVhdGVDYXJkLFxuICAgIC8vICAgfSxcbiAgICAvLyAgIFwiI2NhcmRzX19saXN0XCJcbiAgICAvLyApO1xuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMocmVzdWx0LnJldmVyc2UoKSk7XG4gIH0pXG4gIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXG4gIH0pO1xuXG4vLyBmZXRjaCBhbmQgcmVuZGVyIHVzZXIgaW5mb1xuYXBpXG4gIC5nZXRVc2VySW5mbygpXG4gIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAvLyB1cGRhdGUgVUkgdG8gcmVmbGVjdCB0aGUgdXNlciBpbmZvIGZyb20gdGhlIGRiXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzdWx0Lm5hbWUsIHJlc3VsdC5hYm91dCk7XG4gICAgdXNlckluZm8uc2V0QXZhdGFyKHJlc3VsdC5hdmF0YXIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxuICB9KTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4vLyA9PT09PT09PT0gIEZVTkNUSU9OUyAgPT09PT09PT09IC8vXG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcbiAgY29uc3QgY2FyZFZpZXcgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcbiAgLy8gY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKHt9LCBcIiNjYXJkc19fbGlzdFwiKTtcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRWaWV3KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2FyZCxcbiAgICBoYW5kbGVMaWtlQ2xpY2ssXG4gICAgaGFuZGxlVW5saWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKHsgbmFtZSwgbGluayB9KSB7XG4gIC8vIG9wZW4gdGhlIHBvcHVwIHdpdGggdGhlIGltYWdlXG4gIHBvcHVwV2l0aEltYWdlLm9wZW4oeyBsaW5rLCBuYW1lIH0pO1xufVxuXG4vLyA9PT09PT09PT0gIEVWRU5UIEhBTkRMRVJTICA9PT09PT09PT0gLy9cblxuLy8gSGFuZGxlcyBlZGl0IGZvcm0gc3VibWl0XG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdCh7IHRpdGxlLCBkZXNjcmlwdGlvbiB9KSB7XG4gIGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLmVkaXRQcm9maWxlSW5mbyh7XG4gICAgICBuYW1lOiB0aXRsZSxcbiAgICAgIGFib3V0OiBkZXNjcmlwdGlvbixcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhkYXRhLm5hbWUsIGRhdGEuYWJvdXQpO1xuICAgICAgZWRpdEZvcm1WYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbi8vIGhhbmRsZXMgbmV3IGNhcmQgc3VibWlzc2lvblxuZnVuY3Rpb24gaGFuZGxlTmV3Q2FyZFN1Ym1pdChuYW1lLCBsaW5rKSB7XG4gIG5ld0NhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAuYWRkTmV3Q2FyZCh7XG4gICAgICBuYW1lOiBuYW1lLFxuICAgICAgbGluazogbGluayxcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICByZW5kZXJDYXJkKGRhdGEpO1xuICAgICAgY2FyZEZvcm1WYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgbmV3Q2FyZFBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vLyBoYW5kbGVzIGRlbGV0aW5nIGNhcmRcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmQoY2FyZCkge1xuICAvLyBvcGVuIHRoZSBkZWxldGUgY2FyZCBwb3B1cFxuICBkZWxldGVDYXJkUG9wdXAub3BlbigpO1xuICBkZWxldGVDYXJkUG9wdXAuc2V0U3VibWl0Q2FsbGJhY2soKCkgPT4ge1xuICAgIGFwaVxuICAgICAgLmRlbGV0ZUNhcmQoY2FyZC5nZXRJZCgpKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLmRlbGV0ZUNhcmQoKTtcbiAgICAgICAgZGVsZXRlQ2FyZFBvcHVwLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgfSk7XG4gIH0pO1xufVxuXG4vLyBmdW5jdGlvbiB0byBoYW5kbGUgbGlrZSBidXR0b24gY2xpY2tcbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGFwaVxuICAgIC5saWtlQ2FyZChjYXJkLl9pZClcbiAgICAudGhlbigoZGF0YSkgPT4ge1xuICAgICAgY2FyZC5oYW5kbGVMaWtlSWNvbigpO1xuICAgICAgY2FyZC5pc0xpa2VkID0gdHJ1ZTtcbiAgICAgIGNvbnNvbGUubG9nKFwiQ2FyZCBsaWtlZDpcIiwgZGF0YSk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVVbmxpa2VDbGljayhjYXJkKSB7XG4gIGFwaVxuICAgIC5yZW1vdmVMaWtlKGNhcmQuX2lkKVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjYXJkLmhhbmRsZUxpa2VJY29uKCk7XG4gICAgICBjYXJkLmlzTGlrZWQgPSBmYWxzZTtcbiAgICAgIGNvbnNvbGUubG9nKFwiQ2FyZCBkaXNsaWtlZDpcIiwgZGF0YSk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICB9KTtcbn1cblxuLy8gaGFuZGxlcyBhdmF0YXIgZm9ybSBzdWJtaXQgd2l0aCBhcGlcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclN1Ym1pdChmb3JtRGF0YSkge1xuICBjaGFuZ2VBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBjb25zdCBhdmF0YXIgPSBmb3JtRGF0YS5saW5rO1xuICBhcGlcbiAgICAudXBkYXRlQXZhdGFyKHtcbiAgICAgIGF2YXRhcixcbiAgICB9KVxuICAgIC50aGVuKChkYXRhKSA9PiB7XG4gICAgICBjaGFuZ2VBdmF0YXJQb3B1cC5jbG9zZSgpO1xuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKGRhdGEuYXZhdGFyKTtcbiAgICAgIGF2YXRhckZvcm1WYWxpZGF0b3IuZGlzYWJsZVN1Ym1pdEJ1dHRvbigpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGNoYW5nZUF2YXRhclBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgIH0pO1xufVxuXG4vLyA9PT09PT09PT0gIEVWRU5UIExJU1RFTkVSUyAgPT09PT09PT09IC8vXG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSB1c2VyRGF0YS50aXRsZTtcbiAgcHJvZmlsZURlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSB1c2VyRGF0YS5kZXNjcmlwdGlvbjtcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xufSk7XG5cbi8vIExpc3RlbnMgZm9yIGFkZCBidXR0b24gY2xpY2ssIGZ1bmN0aW9ucyB0byBvcGVuIG5ldyBjYXJkIGZyb20gbW9kYWwuXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIG5ld0NhcmRQb3B1cC5vcGVuKCk7XG59KTtcblxuLy8gTGlzdGVucyBmb3IgYXZhdGFyIGNsaWNrLCBmdW5jdGlvbnMgdG8gb3BlbiBjaGFuZ2UgYXZhdGFyIG1vZGFsLlxucHJvZmlsZUF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjaGFuZ2VBdmF0YXJQb3B1cC5vcGVuKCk7XG59KTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5jbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICAvLyBjbGFzcyBmaWVsZHMgZGVmaW5lZFxuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3BvcHVwLWNhcHRpb25cIlxuICAgICk7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICB9XG5cbiAgb3Blbih7IGxpbmssIG5hbWUgfSkge1xuICAgIHRoaXMuX3BvcHVwQ2FwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LnNyYyA9IGxpbms7XG4gICAgdGhpcy5faW1hZ2VFbGVtZW50LmFsdCA9IGBJbWFnZSBvZiAke25hbWV9YDtcblxuICAgIHN1cGVyLm9wZW4oKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBQb3B1cFdpdGhJbWFnZTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5jbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gIH1cblxuICAvLyBzZXQgZXZlbnQgbGlzdGVuZXJzXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIHNldCBzdWJtaXQgY2FsbGJhY2tcbiAgc2V0U3VibWl0Q2FsbGJhY2soYWN0aW9uKSB7XG4gICAgLy8gc2V0IHN1Ym1pdCBoYW5kbGVyXG4gICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFBvcHVwV2l0aENvbmZpcm1hdGlvbjtcbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gIC8vIHBhc3MgaW4gc2VsZWN0b3IncyBhcyBhcmd1bWVudHNcbiAgY29uc3RydWN0b3IoXG4gICAgcHJvZmlsZVRpdGxlU2VsZWN0b3IsXG4gICAgcHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3IsXG4gICAgcHJvZmlsZUF2YXRhclNlbGVjdG9yXG4gICkge1xuICAgIC8vIHVzZSBxdWVyeSBzZWxlY3RvciB0byBnZXQgZWxlbWVudHMgYW5kIGFzc2lnbiB0byB0aGlzXG4gICAgdGhpcy5fcHJvZmlsZVRpdGxlRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZVRpdGxlU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgcHJvZmlsZURlc2NyaXB0aW9uU2VsZWN0b3JcbiAgICApO1xuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXJFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlQXZhdGFyU2VsZWN0b3IpO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgLy8gcmV0dXJuIG9iamVjdCBjb250YWluaW5nIHRoZSB0ZXh0IGNvbnRlbnQgb2YgdGhlIHByb2ZpbGUgZWxlbWVudHNcbiAgICByZXR1cm4ge1xuICAgICAgdGl0bGU6IHRoaXMuX3Byb2ZpbGVUaXRsZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgLy8gcGFzcyBpbiB0aGUgdmFsdWVzIGZyb20gdGhlIGZvcm0gc3VibWlzc2lvblxuICBzZXRVc2VySW5mbyh0aXRsZSwgZGVzY3JpcHRpb24pIHtcbiAgICB0aGlzLl9wcm9maWxlVGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gdGl0bGU7XG4gICAgdGhpcy5fcHJvZmlsZURlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xuICAgIC8vIHNpbWlsYXJseSBmb3IgdGhlIG90aGVyIGVsZW1lbnRcbiAgfVxuXG4gIHNldEF2YXRhcihsaW5rKSB7XG4gICAgLy8gc2V0IHRoZSBcInNyY1wiIG9mIHRoZSBhdmF0YXIgZWxlbWVudFxuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXJFbGVtZW50LnNyYyA9IGxpbms7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgVXNlckluZm87XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgICB0aGlzLl9jaGVja1Jlc3BvbnNlID0gdGhpcy5fY2hlY2tSZXNwb25zZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgLy8gbWV0aG9kIGZvciBjaGVja2luZyByZXNwb25zZSBzdGF0dXNcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIC8vIHJlcXVlc3QgbWV0aG9kXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICAvLyBmdW5jdGlvbiB0byBnZXQgdXNlciBpbmZvIGZyb20gdGhlIHNlcnZlclxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gbG9hZGluZyBjYXJkcyBmcm9tIHRoZSBzZXJ2ZXJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgfSk7XG4gIH1cblxuICAvLyBlZGl0aW5nIHRoZSBwcm9maWxlXG4gIGVkaXRQcm9maWxlSW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgIGFib3V0OiBhYm91dCxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gYWRkaW5nIGEgbmV3IGNhcmRcbiAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICBsaW5rOiBsaW5rLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICAvLyBkZWxldGluZyBhIGNhcmRcbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcbiAgICB9KTtcbiAgfVxuXG4gIC8vIGxpa2UgYSBjYXJkXG4gIGxpa2VDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gcmVtb3ZlIGEgbGlrZVxuICByZW1vdmVMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgLy8gdXBkYXRpbmcgdGhlIHByb2ZpbGUgcGljdHVyZVxuICB1cGRhdGVBdmF0YXIoeyBhdmF0YXIgfSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIGF2YXRhcjogYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNhcmQiLCJoYW5kbGVMaWtlQ2xpY2siLCJoYW5kbGVVbmxpa2VDbGljayIsIm5hbWUiLCJsaW5rIiwiX2lkIiwiaXNMaWtlZCIsInRoaXMiLCJfbmFtZSIsIl9saW5rIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVVbmxpa2VDbGljayIsImdldElkIiwiZ2V0SXNMaWtlZCIsIl9pc0xpa2VkIiwiX2dldEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2V0VmlldyIsIl9jYXJkRWxlbWVudCIsIl9saWtlQnV0dG9uIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2VFbCIsIl9jYXJkVGl0bGVFbCIsInNyYyIsImFsdCIsInRleHRDb250ZW50IiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX3NldExpa2VTdGF0ZSIsImNsYXNzTGlzdCIsImFkZCIsInJlbW92ZSIsImhhbmRsZUxpa2VJY29uIiwidG9nZ2xlIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRlbGV0ZUNhcmQiLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9pbnB1dEVsZW1lbnRzIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zdWJtaXRCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2hhc0ludmFsaWRJbnB1dCIsIkFycmF5IiwiZnJvbSIsInNvbWUiLCJfZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiX2VuYWJsZUJ1dHRvbiIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvckVhY2giLCJyZXNldFZhbGlkYXRpb24iLCJkaXNhYmxlU3VibWl0QnV0dG9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVLZXlEb3duIiwiYmluZCIsIm9wZW4iLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsImNsb3NlQnV0dG9uIiwidGFyZ2V0IiwiY29udGFpbnMiLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfcG9wdXBGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfaW5wdXRGaWVsZHMiLCJfZm9ybVN1Ym1pdEhhbmRsZXIiLCJfc3VibWl0QnRuIiwiX3N1Ym1pdEJ0blRleHQiLCJyZW5kZXJMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsImZvcm1TZWxlY3RvciIsInByb2ZpbGVBZGRCdXR0b24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVBdmF0YXJCdXR0b24iLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwiZm9ybXMiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImNhcmRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsIm5ld0NhcmRQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJmb3JtRGF0YSIsInRpdGxlIiwiYXBpIiwiYWRkTmV3Q2FyZCIsInRoZW4iLCJkYXRhIiwiY2FyZERhdGEiLCJjYXJkVmlldyIsImNyZWF0ZUNhcmQiLCJzZWN0aW9uIiwiYWRkSXRlbSIsInJlbmRlckNhcmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImZpbmFsbHkiLCJlZGl0UHJvZmlsZVBvcHVwIiwiX3JlZjIiLCJkZXNjcmlwdGlvbiIsImVkaXRQcm9maWxlSW5mbyIsImFib3V0IiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInBvcHVwV2l0aEltYWdlIiwiX3BvcHVwQ2FwdGlvbiIsIl9pbWFnZUVsZW1lbnQiLCJkZWxldGVDYXJkUG9wdXAiLCJfaGFuZGxlU3VibWl0Iiwic2V0U3VibWl0Q2FsbGJhY2siLCJhY3Rpb24iLCJoYW5kbGVEZWxldGVDYXJkIiwiY2hhbmdlQXZhdGFyUG9wdXAiLCJhdmF0YXIiLCJ1cGRhdGVBdmF0YXIiLCJzZXRBdmF0YXIiLCJwcm9maWxlVGl0bGVTZWxlY3RvciIsInByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yIiwicHJvZmlsZUF2YXRhclNlbGVjdG9yIiwiX3Byb2ZpbGVUaXRsZUVsZW1lbnQiLCJfcHJvZmlsZURlc2NyaXB0aW9uRWxlbWVudCIsIl9wcm9maWxlQXZhdGFyRWxlbWVudCIsImdldFVzZXJJbmZvIiwib3B0aW9ucyIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2NoZWNrUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJ1cmwiLCJmZXRjaCIsImdldEluaXRpYWxDYXJkcyIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiY2FyZElkIiwibGlrZUNhcmQiLCJyZW1vdmVMaWtlIiwiX3JlZjMiLCJhdXRob3JpemF0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJyZW5kZXJlciIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW1zIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiY2FyZCIsImxvZyIsInJlc3VsdCIsInJldmVyc2UiLCJ1c2VyRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=